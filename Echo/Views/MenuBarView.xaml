<UserControl x:Class="Echo.Views.MenuBarView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:sysconv="clr-namespace:System.Windows.Controls;assembly=PresentationFramework"
             xmlns:vm="clr-namespace:Echo.ViewModels"
             xmlns:converters="clr-namespace:Echo.Converters" 
             xmlns:resx="clr-namespace:Echo.Resources"
             mc:Ignorable="d"
             Height="30"
             Background="#F5F5F5"
             >

    <UserControl.DataContext>
        <vm:MenuBarViewModel/>
    </UserControl.DataContext>

    <UserControl.Resources>
        <sysconv:BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        <converters:AspectRatioConverter x:Key="AspectRatioConverter"/>
        <converters:AspectRatioConverter x:Key="LanguageConverter"/>
        <!-- MenuItem 基础样式 -->
        <Style x:Key="MenuItemStyle" TargetType="MenuItem">
            <Setter Property="Background" Value="#F5F5F5"/>
            <Setter Property="Foreground" Value="#2D2D2D"/>
            <Style.Triggers>
                <Trigger Property="IsHighlighted" Value="True">
                    <Setter Property="Background" Value="#E0E0E0"/>
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Foreground" Value="#A0A0A0"/>
                </Trigger>
                <Trigger Property="Role" Value="TopLevelHeader">
                    <Setter Property="Padding" Value="10,5"/>
                    <Setter Property="Margin" Value="2,0"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- 分隔线样式 -->
        <Style x:Key="SeparatorStyle" TargetType="Separator">
            <Setter Property="Background" Value="#F5F5F5"/>
            <Setter Property="BorderBrush" Value="#D0D0D0"/>
            <Setter Property="Margin" Value="0"/>
            <Setter Property="Height" Value="1"/>
        </Style>

        <!-- 菜单样式 -->
        <Style x:Key="MenuStyle" TargetType="Menu">
            <Setter Property="Background" Value="#F5F5F5"/>
            <Setter Property="Padding" Value="5,2"/>
        </Style>

        <!-- 子菜单面板样式 -->
        <Style x:Key="ContextMenuStyle" TargetType="ContextMenu">
            <Setter Property="Background" Value="#F5F5F5"/>
            <Setter Property="BorderBrush" Value="#D0D0D0"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>
    </UserControl.Resources>

    <UserControl.Visibility>
        <Binding Path="IsMenuBarVisible"
                 Converter="{StaticResource BooleanToVisibilityConverter}" />
    </UserControl.Visibility>

    <Menu >
        <!-- 文件菜单 -->
        <MenuItem Header="{x:Static resx:LangResx.File}" Style="{StaticResource MenuItemStyle}">
            <MenuItem Header="{x:Static resx:LangResx.Open_File}" 
                      Command="{Binding OpenFileCommand}"
                      Style="{StaticResource MenuItemStyle}">
                <MenuItem.Icon>
                    <TextBlock Text="📂" FontSize="14"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem Header="{x:Static resx:LangResx.Recent_Files}" 
                      IsEnabled="False"
                      Style="{StaticResource MenuItemStyle}">
                <MenuItem.Icon>
                    <TextBlock Text="📋" FontSize="14"/>
                </MenuItem.Icon>
            </MenuItem>
            <Separator Style="{StaticResource SeparatorStyle}"/>
            <MenuItem Header="{x:Static resx:LangResx.Exit}" 
                      Command="{Binding ExitCommand}"
                      Style="{StaticResource MenuItemStyle}">
                <MenuItem.Icon>
                    <TextBlock Text="🚪" FontSize="14"/>
                </MenuItem.Icon>
            </MenuItem>
        </MenuItem>

        <!-- 视频菜单 -->
        <MenuItem Header="{x:Static resx:LangResx.Video}" Style="{StaticResource MenuItemStyle}">
            <MenuItem Header="{x:Static resx:LangResx.Snapshot}" 
                      Command="{Binding ScreenshotCommand}"
                      Style="{StaticResource MenuItemStyle}">
                <MenuItem.Icon>
                    <TextBlock Text="📸" FontSize="14"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem Header="{x:Static resx:LangResx.Aspect_Ratio}" Style="{StaticResource MenuItemStyle}">
                <MenuItem Header="{x:Static resx:LangResx.Default}" 
              IsCheckable="True" 
              IsChecked="{Binding SelectedAspectRatio, Converter={StaticResource AspectRatioConverter}, ConverterParameter='Default'}"
              Command="{Binding ChangeAspectRatioCommand}" 
              CommandParameter="Default" 
              Style="{StaticResource MenuItemStyle}"/>
                <MenuItem Header="16:10" 
              IsCheckable="True" 
              IsChecked="{Binding SelectedAspectRatio, Converter={StaticResource AspectRatioConverter}, ConverterParameter='16:10'}"
              Command="{Binding ChangeAspectRatioCommand}" 
              CommandParameter="16:10" 
              Style="{StaticResource MenuItemStyle}"/>
                <MenuItem Header="16:9" 
              IsCheckable="True" 
              IsChecked="{Binding SelectedAspectRatio, Converter={StaticResource AspectRatioConverter}, ConverterParameter='16:9'}"
              Command="{Binding ChangeAspectRatioCommand}" 
              CommandParameter="16:9" 
              Style="{StaticResource MenuItemStyle}"/>
                <MenuItem Header="4:3" 
              IsCheckable="True" 
              IsChecked="{Binding SelectedAspectRatio, Converter={StaticResource AspectRatioConverter}, ConverterParameter='4:3'}"
              Command="{Binding ChangeAspectRatioCommand}" 
              CommandParameter="4:3" 
              Style="{StaticResource MenuItemStyle}"/>
                <MenuItem Header="1:1" 
              IsCheckable="True" 
              IsChecked="{Binding SelectedAspectRatio, Converter={StaticResource AspectRatioConverter}, ConverterParameter='1:1'}"
              Command="{Binding ChangeAspectRatioCommand}" 
              CommandParameter="1:1" 
              Style="{StaticResource MenuItemStyle}"/>
            </MenuItem>

            <!-- 
            <MenuItem Header="缩放" Style="{StaticResource MenuItemStyle}">
                <MenuItem Header="50%" Command="{Binding ChangeScaleCommand}" CommandParameter="0.5" Style="{StaticResource MenuItemStyle}"/>
                <MenuItem Header="75%" Command="{Binding ChangeScaleCommand}" CommandParameter="0.75" Style="{StaticResource MenuItemStyle}"/>
                <MenuItem Header="100%" Command="{Binding ChangeScaleCommand}" CommandParameter="1.0" Style="{StaticResource MenuItemStyle}"/>
            </MenuItem> -->
            <MenuItem Header="{x:Static resx:LangResx.Fullscreen}" 
                      Command="{Binding ToggleFullScreenCommand}"
                      Style="{StaticResource MenuItemStyle}">
                <MenuItem.Icon>
                    <TextBlock Text="⛶" FontSize="14"/>
                </MenuItem.Icon>
            </MenuItem>
        </MenuItem>

        <!-- 字幕菜单 -->
        <MenuItem Header="{x:Static resx:LangResx.Subtitles}" Style="{StaticResource MenuItemStyle}">
            <MenuItem Header="{x:Static resx:LangResx.Show_Subtitles}" 
                      IsCheckable="True"
                      IsChecked="{Binding IsSubtitleVisible}"
                      Style="{StaticResource MenuItemStyle}"/>
            <MenuItem Header="{x:Static resx:LangResx.Open_Subtitles}" 
                      Command="{Binding OpenSubtitleCommand}"
                      Style="{StaticResource MenuItemStyle}">
                <MenuItem.Icon>
                    <TextBlock Text="📝" FontSize="14"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem Header="{x:Static resx:LangResx.Select_Subtitles}" Style="{StaticResource MenuItemStyle}">
                <MenuItem Header="选择字幕轨" 
                          Command="{Binding SelectSubtitleTrackCommand}"
                          Style="{StaticResource MenuItemStyle}"/>
            </MenuItem>
            <Separator Style="{StaticResource SeparatorStyle}"/>
            <MenuItem Header="{x:Static resx:LangResx.Show_Subtitles_on_Mouse_Hover}" 
                      IsCheckable="True"
                      IsChecked="{Binding IsMouseHoverEnabled}"
                      Style="{StaticResource MenuItemStyle}"/>
            <MenuItem Header="{x:Static resx:LangResx.Sentence_Analysis}" 
                      IsCheckable="True"
                      IsChecked="{Binding IsSentenceAnalysisEnabled}"
                      Style="{StaticResource MenuItemStyle}"/>
            <MenuItem Header="{x:Static resx:LangResx.Word_Click}" 
                      IsCheckable="True"
                      IsChecked="{Binding IsWordQueryEnabled}"
                      Style="{StaticResource MenuItemStyle}"/>
            <!-- todo 
            <MenuItem Header="字幕显示位置" Style="{StaticResource MenuItemStyle}">
                <MenuItem Header="顶部" 
                          Command="{Binding ChangeSubtitlePositionCommand}"
                          CommandParameter="Top"
                          Style="{StaticResource MenuItemStyle}"/>
                <MenuItem Header="底部" 
                          Command="{Binding ChangeSubtitlePositionCommand}"
                          CommandParameter="Bottom"
                          Style="{StaticResource MenuItemStyle}"/>
            </MenuItem>
            -->
            <MenuItem Header="{x:Static resx:LangResx.Advanced_Settings}" Style="{StaticResource MenuItemStyle}">
                <MenuItem Header="{x:Static resx:LangResx.Subtitle_Opacity}" Style="{StaticResource MenuItemStyle}">
                    <MenuItem Header="0%" Command="{Binding ChangeOpacityCommand}" CommandParameter="0" Style="{StaticResource MenuItemStyle}"/>
                    <MenuItem Header="25%" Command="{Binding ChangeOpacityCommand}" CommandParameter="0.25" Style="{StaticResource MenuItemStyle}"/>
                    <MenuItem Header="50%" Command="{Binding ChangeOpacityCommand}" CommandParameter="0.5" Style="{StaticResource MenuItemStyle}"/>
                    <MenuItem Header="75%" Command="{Binding ChangeOpacityCommand}" CommandParameter="0.75" Style="{StaticResource MenuItemStyle}"/>
                    <MenuItem Header="100%" Command="{Binding ChangeOpacityCommand}" CommandParameter="1" Style="{StaticResource MenuItemStyle}"/>
                </MenuItem>
                <MenuItem Header="{x:Static resx:LangResx.Subtitle_Style}" Style="{StaticResource MenuItemStyle}">
                    <MenuItem Header="{x:Static resx:LangResx.Subtitle_Font_Size}" Style="{StaticResource MenuItemStyle}">
                        <MenuItem Header="{x:Static resx:LangResx.Small}" Command="{Binding ChangeFontSizeCommand}" CommandParameter="16" Style="{StaticResource MenuItemStyle}"/>
                        <MenuItem Header="{x:Static resx:LangResx.Medium}" Command="{Binding ChangeFontSizeCommand}" CommandParameter="20" Style="{StaticResource MenuItemStyle}"/>
                        <MenuItem Header="{x:Static resx:LangResx.Large}" Command="{Binding ChangeFontSizeCommand}" CommandParameter="24" Style="{StaticResource MenuItemStyle}"/>
                    </MenuItem>
                    <!-- todo 
                    <MenuItem Header="字体" Style="{StaticResource MenuItemStyle}">
                        <MenuItem Header="微软雅黑" Command="{Binding ChangeFontFamilyCommand}" CommandParameter="Microsoft YaHei" Style="{StaticResource MenuItemStyle}"/>
                        <MenuItem Header="宋体" Command="{Binding ChangeFontFamilyCommand}" CommandParameter="SimSun" Style="{StaticResource MenuItemStyle}"/>
                        <MenuItem Header="黑体" Command="{Binding ChangeFontFamilyCommand}" CommandParameter="SimHei" Style="{StaticResource MenuItemStyle}"/>
                    </MenuItem>
                    -->
                </MenuItem>
                <!-- todo 
                <MenuItem Header="滚动字幕" 
                            IsCheckable="True"
                            Command="{Binding ToggleScrollSubtitleCommand}"
                            IsChecked="{Binding IsScrollSubtitleEnabled, Mode=OneWay}"
                            Style="{StaticResource MenuItemStyle}"/>
                -->
            </MenuItem>
            <Separator Style="{StaticResource SeparatorStyle}"/>
            <!-- todo 
            <MenuItem Header="第二字幕" Style="{StaticResource MenuItemStyle}">
                <MenuItem Header="选择字幕轨" 
                          Command="{Binding SelectSecondarySubtitleTrackCommand}"
                          Style="{StaticResource MenuItemStyle}"/>
                <MenuItem Header="设置显示位置" Style="{StaticResource MenuItemStyle}">
                    <MenuItem Header="顶部" Command="{Binding ChangeSecondarySubtitlePositionCommand}" CommandParameter="Top" Style="{StaticResource MenuItemStyle}"/>
                    <MenuItem Header="底部" Command="{Binding ChangeSecondarySubtitlePositionCommand}" CommandParameter="Bottom" Style="{StaticResource MenuItemStyle}"/>
                </MenuItem>
            </MenuItem>
            -->
            <!-- todo 
            <MenuItem Header="自动翻译" 
                          Command="{Binding AutoTranslateVideoCommand}"
                          Style="{StaticResource MenuItemStyle}"/>
            -->
            <!-- todo 
            <MenuItem Header="字幕同步调整" 
                          Command="{Binding AdjustSubtitleSyncCommand}"
                          Style="{StaticResource MenuItemStyle}">
                
             </MenuItem>
             -->
        </MenuItem>

        <!-- 词典菜单 -->
        <MenuItem Header="{x:Static resx:LangResx.Learn}" Style="{StaticResource MenuItemStyle}">
            <MenuItem Header="{x:Static resx:LangResx.Language}" Style="{StaticResource MenuItemStyle}">
                <MenuItem Header="{x:Static resx:LangResx.Your_Language}" Style="{StaticResource MenuItemStyle}">
                    
                    <MenuItem Header="简体中文" 
                              IsChecked="{Binding SelectedYourLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='zh'}" 
                              Command="{Binding ChangeYourLanguageCommand}" 
                              CommandParameter="zh" 
                              Style="{StaticResource MenuItemStyle}"/>
                    <!-- todo
                    <MenuItem Header="繁体中文" 
                              IsChecked="{Binding SelectedYourLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='zh-Hant'}" 
                              Command="{Binding ChangeYourLanguageCommand}" 
                              CommandParameter="zh-Hant" 
                              Style="{StaticResource MenuItemStyle}"/>
                    -->
                    <MenuItem Header="English" 
                              IsChecked="{Binding SelectedYourLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='en'}" 
                              Command="{Binding ChangeYourLanguageCommand}" 
                              CommandParameter="en" 
                              Style="{StaticResource MenuItemStyle}"/>
                    <!-- todo
                    <MenuItem Header="日本語" 
                              IsChecked="{Binding SelectedYourLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='ja'}" 
                              Command="{Binding ChangeYourLanguageCommand}" 
                              CommandParameter="ja" 
                              Style="{StaticResource MenuItemStyle}"/>
                    -->
                    <!-- todo
                    <MenuItem Header="한국어" 
                              IsChecked="{Binding SelectedYourLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='ko'}" 
                              Command="{Binding ChangeYourLanguageCommand}" 
                              CommandParameter="ko" 
                              Style="{StaticResource MenuItemStyle}"/>
                    -->
                    <MenuItem Header="Français" 
                              IsChecked="{Binding SelectedYourLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='fr'}" 
                              Command="{Binding ChangeYourLanguageCommand}" 
                              CommandParameter="fr" 
                              Style="{StaticResource MenuItemStyle}"/>
                    <MenuItem Header="Deutsch" 
                              IsChecked="{Binding SelectedYourLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='de'}" 
                              Command="{Binding ChangeYourLanguageCommand}" 
                              CommandParameter="de" 
                              Style="{StaticResource MenuItemStyle}"/>
                    <MenuItem Header="Español" 
                              IsChecked="{Binding SelectedYourLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='es'}" 
                              Command="{Binding ChangeYourLanguageCommand}" 
                              CommandParameter="es" 
                              Style="{StaticResource MenuItemStyle}"/>
                    <MenuItem Header="العربية" 
                              IsChecked="{Binding SelectedYourLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='ar'}" 
                              Command="{Binding ChangeYourLanguageCommand}" 
                              CommandParameter="ar" 
                              Style="{StaticResource MenuItemStyle}"/>
                    <MenuItem Header="Русский" 
                              IsChecked="{Binding SelectedYourLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='ru'}" 
                              Command="{Binding ChangeYourLanguageCommand}" 
                              CommandParameter="ru" 
                              Style="{StaticResource MenuItemStyle}"/>
                    <!-- todo
                    <MenuItem Header="Українська" 
                              IsChecked="{Binding SelectedYourLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='uk'}" 
                              Command="{Binding ChangeYourLanguageCommand}" 
                              CommandParameter="uk" 
                              Style="{StaticResource MenuItemStyle}"/>
                    -->
                    <MenuItem Header="Português" 
                              IsChecked="{Binding SelectedYourLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='pt'}" 
                              Command="{Binding ChangeYourLanguageCommand}" 
                              CommandParameter="pt" 
                              Style="{StaticResource MenuItemStyle}"/>
                    <MenuItem Header="Italiano" 
                              IsChecked="{Binding SelectedYourLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='it'}" 
                              Command="{Binding ChangeYourLanguageCommand}" 
                              CommandParameter="it" 
                              Style="{StaticResource MenuItemStyle}"/>
                </MenuItem>
                <MenuItem Header="{x:Static resx:LangResx.Learning_Language}" Style="{StaticResource MenuItemStyle}">
                    <MenuItem Header="{x:Static resx:LangResx.Auto_Detect}" 
                              IsChecked="{Binding SelectedLearningLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='Auto'}" 
                              Command="{Binding ChangeLearningLanguageCommand}" CommandParameter="Auto" Style="{StaticResource MenuItemStyle}"/>
                    
                    <MenuItem Header="简体中文" 
                              IsChecked="{Binding SelectedLearningLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='zh'}" 
                              Command="{Binding ChangeLearningLanguageCommand}" 
                              CommandParameter="zh" 
                              Style="{StaticResource MenuItemStyle}"/>
                    <!-- todo
                    <MenuItem Header="繁体中文" 
                              IsChecked="{Binding SelectedLearningLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='zh-Hant'}" 
                              Command="{Binding ChangeLearningLanguageCommand}" 
                              CommandParameter="zh-Hant" 
                              Style="{StaticResource MenuItemStyle}"/>
                    -->
                    <MenuItem Header="English" 
                              IsChecked="{Binding SelectedLearningLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='en'}" 
                              Command="{Binding ChangeLearningLanguageCommand}" 
                              CommandParameter="en" 
                              Style="{StaticResource MenuItemStyle}"/>
                    <!-- todo
                    <MenuItem Header="日本語" 
                              IsChecked="{Binding SelectedLearningLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='ja'}" 
                              Command="{Binding ChangeLearningLanguageCommand}" 
                              CommandParameter="ja" 
                              Style="{StaticResource MenuItemStyle}"/>
                    -->
                    <!-- todo
                    <MenuItem Header="한국어" 
                              IsChecked="{Binding SelectedLearningLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='ko'}" 
                              Command="{Binding ChangeLearningLanguageCommand}" 
                              CommandParameter="ko" 
                              Style="{StaticResource MenuItemStyle}"/>
                    -->
                    <MenuItem Header="Français" 
                              IsChecked="{Binding SelectedLearningLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='fr'}" 
                              Command="{Binding ChangeLearningLanguageCommand}" 
                              CommandParameter="fr" 
                              Style="{StaticResource MenuItemStyle}"/>
                    <MenuItem Header="Deutsch" 
                              IsChecked="{Binding SelectedLearningLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='de'}" 
                              Command="{Binding ChangeLearningLanguageCommand}" 
                              CommandParameter="de" 
                              Style="{StaticResource MenuItemStyle}"/>
                    <MenuItem Header="Español" 
                              IsChecked="{Binding SelectedLearningLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='es'}" 
                              Command="{Binding ChangeLearningLanguageCommand}" 
                              CommandParameter="es" 
                              Style="{StaticResource MenuItemStyle}"/>
                    <MenuItem Header="العربية" 
                              IsChecked="{Binding SelectedLearningLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='ar'}" 
                              Command="{Binding ChangeLearningLanguageCommand}" 
                              CommandParameter="ar" 
                              Style="{StaticResource MenuItemStyle}"/>
                    <MenuItem Header="Русский" 
                              IsChecked="{Binding SelectedLearningLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='ru'}" 
                              Command="{Binding ChangeLearningLanguageCommand}" 
                              CommandParameter="ru" 
                              Style="{StaticResource MenuItemStyle}"/>
                    <!-- todo
                    <MenuItem Header="Українська" 
                              IsChecked="{Binding SelectedLearningLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='uk'}" 
                              Command="{Binding ChangeLearningLanguageCommand}" 
                              CommandParameter="uk" 
                              Style="{StaticResource MenuItemStyle}"/>
                    -->
                    <MenuItem Header="Português" 
                              IsChecked="{Binding SelectedLearningLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='pt'}" 
                              Command="{Binding ChangeLearningLanguageCommand}" 
                              CommandParameter="pt" 
                              Style="{StaticResource MenuItemStyle}"/>
                    <MenuItem Header="Italiano" 
                              IsChecked="{Binding SelectedLearningLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='it'}" 
                              Command="{Binding ChangeLearningLanguageCommand}" 
                              CommandParameter="it" 
                              Style="{StaticResource MenuItemStyle}"/>
                </MenuItem>
                <MenuItem Header="{x:Static resx:LangResx.Software_Language}">
                    <MenuItem Header="简体中文" 
                              IsChecked="{Binding SelectedSoftwareLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='zh-Hans'}"
                              Command="{Binding SoftwareLanguageChangeCommand}" 
                              CommandParameter="zh-Hans" />
                    <MenuItem Header="繁体中文" 
                              IsChecked="{Binding SelectedSoftwareLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='zh-Hant'}"
                              Command="{Binding SoftwareLanguageChangeCommand}" 
                              CommandParameter="zh-Hant" />
                    <MenuItem Header="English" 
                              IsChecked="{Binding SelectedSoftwareLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='en-US'}"
                              Command="{Binding SoftwareLanguageChangeCommand}" 
                              CommandParameter="en-US" />
                    <MenuItem Header="日本語" 
                              IsChecked="{Binding SelectedSoftwareLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='ja-JP'}"
                              Command="{Binding SoftwareLanguageChangeCommand}" 
                              CommandParameter="ja-JP" />
                    <MenuItem Header="한국어" 
                              IsChecked="{Binding SelectedSoftwareLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='ko-KR'}"
                              Command="{Binding SoftwareLanguageChangeCommand}" 
                              CommandParameter="ko-KR" />
                    <MenuItem Header="Français" 
                              IsChecked="{Binding SelectedSoftwareLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='fr'}"
                              Command="{Binding SoftwareLanguageChangeCommand}" 
                              CommandParameter="fr" />
                    <MenuItem Header="Deutsch" 
                              IsChecked="{Binding SelectedSoftwareLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='de-DE'}"
                              Command="{Binding SoftwareLanguageChangeCommand}" 
                              CommandParameter="de-DE" />
                    <MenuItem Header="Español" 
                              IsChecked="{Binding SelectedSoftwareLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='es'}"
                              Command="{Binding SoftwareLanguageChangeCommand}" 
                              CommandParameter="es" />
                    <MenuItem Header="العربية" 
                              IsChecked="{Binding SelectedSoftwareLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='ar'}"
                              Command="{Binding SoftwareLanguageChangeCommand}" 
                              CommandParameter="ar" />
                    <MenuItem Header="Русский" 
                              IsChecked="{Binding SelectedSoftwareLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='ru'}"
                              Command="{Binding SoftwareLanguageChangeCommand}" 
                              CommandParameter="ru" />
                    <MenuItem Header="Українська" 
                              IsChecked="{Binding SelectedSoftwareLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='uk-UA'}"
                              Command="{Binding SoftwareLanguageChangeCommand}" 
                              CommandParameter="uk-UA" />
                    <MenuItem Header="Português" 
                              IsChecked="{Binding SelectedSoftwareLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='pt'}"
                              Command="{Binding SoftwareLanguageChangeCommand}" 
                              CommandParameter="pt" />
                    <MenuItem Header="Italiano" 
                              IsChecked="{Binding SelectedSoftwareLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='it-IT'}"
                              Command="{Binding SoftwareLanguageChangeCommand}" 
                              CommandParameter="it-IT" />
                </MenuItem>
            </MenuItem>
            <MenuItem Header="API" Style="{StaticResource MenuItemStyle}">
                <MenuItem Header="{x:Static resx:LangResx.Dictionary_API}" Style="{StaticResource MenuItemStyle}">
                    <MenuItem Header="{x:Static resx:LangResx.Oxford_Dictionary}" Command="{Binding SelectWordAPICommand}" CommandParameter="oxford" Style="{StaticResource MenuItemStyle}">
                        <MenuItem Header="{x:Static resx:LangResx.Configure_Token}" Command="{Binding ConfigureWordAPICommand}" Style="{StaticResource MenuItemStyle}"/>
                    </MenuItem>
                </MenuItem>
                <MenuItem Header="{x:Static resx:LangResx.Sentence_Analysis_API}" Style="{StaticResource MenuItemStyle}">
                    <MenuItem Header="OpenAI" Command="{Binding SelectSentenceAPICommand}" CommandParameter="openai" Style="{StaticResource MenuItemStyle}">
                        <MenuItem Header="{x:Static resx:LangResx.Configure_Token}" Command="{Binding ConfigureSentenceAPICommand}" Style="{StaticResource MenuItemStyle}"/>
                    </MenuItem>
                </MenuItem>
                <!-- todo 
                <MenuItem Header="自动翻译API">
                    <MenuItem Header="OpenAI" Command="{Binding TranslationAPIChangeCommand}" Tag="openai">
                        <MenuItem Header="配置Token" Command="{Binding SetTranslationAPICommand}"/>
                    </MenuItem>
                </MenuItem>
                 -->
                <Separator/>
                <MenuItem Header="{x:Static resx:LangResx.Echo_Token}">
                    <MenuItem Header="{x:Static resx:LangResx.Input}" Command="{Binding InputEchoAPICommand}"/>
                    <MenuItem Header="{x:Static resx:LangResx.Purchase}" Command="{Binding ButEchoAPICommand}"/>
                </MenuItem>
            </MenuItem>
        </MenuItem>

        <!-- 单词本菜单 -->
        <MenuItem Header="{x:Static resx:LangResx.Vocabulary_Book}">
            <MenuItem Header="{x:Static resx:LangResx.Open}" Command="{Binding OpenNoteCommand}">

            </MenuItem>
            <MenuItem Header="{x:Static resx:LangResx.Auto_Save_Vocabulary}" Command="{Binding ToggleAutoSaveVocabularyCommand}" Style="{StaticResource MenuItemStyle}"/>
            <MenuItem Header="{x:Static resx:LangResx.Save_Vocabulary_by_Video}" Command="{Binding SaveVocabularyByVideoCommand}"/>
            <MenuItem Header="{x:Static resx:LangResx.Export}">
                <MenuItem Header="{x:Static resx:LangResx.Export_as_Markdown}" Command="{Binding ExportMarkdownCommand}"/>
                <MenuItem Header="{x:Static resx:LangResx.Export_as_SQLite_File}" Command="{Binding ExportMarkdownCommand}"/>
            </MenuItem>
        </MenuItem>

        <!-- 控制菜单 -->
        <MenuItem Header="{x:Static resx:LangResx.Control}">
            <MenuItem Header="{x:Static resx:LangResx.Backward_Time}">
                <MenuItem Header="{x:Static resx:LangResx.Fixed_Time}" Command="{Binding BackwardByTimeCommand}"/>
                <MenuItem Header="{x:Static resx:LangResx.Previous_Sentence}" Command="{Binding BackwardBySentenceCommand}"/>
            </MenuItem>
            <MenuItem Header="{x:Static resx:LangResx.Forward_Time}">
                <MenuItem Header="{x:Static resx:LangResx.Fixed_Time}" Command="{Binding ForkwardByTimeCommand}"/>
                <MenuItem Header="{x:Static resx:LangResx.Medium}" Command="{Binding BackwardBySentenceCommand}"/>
            </MenuItem>
            <MenuItem Header="{x:Static resx:LangResx.Fullscreen_Lock}" IsCheckable="True"/>

        </MenuItem>

        <!-- 系统菜单 -->
        <MenuItem Header="{x:Static resx:LangResx.System}">
            <MenuItem Header="{x:Static resx:LangResx.Software_Language}">
                <MenuItem Header="简体中文" 
                          IsChecked="{Binding SelectedSoftwareLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='zh-Hans'}"
                          Command="{Binding SoftwareLanguageChangeCommand}" 
                          CommandParameter="zh-Hans" />
                <MenuItem Header="繁体中文" 
                          IsChecked="{Binding SelectedSoftwareLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='zh-Hant'}"
                          Command="{Binding SoftwareLanguageChangeCommand}" 
                          CommandParameter="zh-Hant" />
                <MenuItem Header="English" 
                          IsChecked="{Binding SelectedSoftwareLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='en-US'}"
                          Command="{Binding SoftwareLanguageChangeCommand}" 
                          CommandParameter="en-US" />
                <MenuItem Header="日本語" 
                          IsChecked="{Binding SelectedSoftwareLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='ja-JP'}"
                          Command="{Binding SoftwareLanguageChangeCommand}" 
                          CommandParameter="ja-JP" />
                <MenuItem Header="한국어" 
                          IsChecked="{Binding SelectedSoftwareLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='ko-KR'}"
                          Command="{Binding SoftwareLanguageChangeCommand}" 
                          CommandParameter="ko-KR" />
                <MenuItem Header="Français" 
                          IsChecked="{Binding SelectedSoftwareLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='fr'}"
                          Command="{Binding SoftwareLanguageChangeCommand}" 
                          CommandParameter="fr" />
                <MenuItem Header="Deutsch" 
                          IsChecked="{Binding SelectedSoftwareLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='de-DE'}"
                          Command="{Binding SoftwareLanguageChangeCommand}" 
                          CommandParameter="de-DE" />
                <MenuItem Header="Español" 
                          IsChecked="{Binding SelectedSoftwareLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='es'}"
                          Command="{Binding SoftwareLanguageChangeCommand}" 
                          CommandParameter="es" />
                <MenuItem Header="العربية" 
                          IsChecked="{Binding SelectedSoftwareLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='ar'}"
                          Command="{Binding SoftwareLanguageChangeCommand}" 
                          CommandParameter="ar" />
                <MenuItem Header="Русский" 
                          IsChecked="{Binding SelectedSoftwareLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='ru'}"
                          Command="{Binding SoftwareLanguageChangeCommand}" 
                          CommandParameter="ru" />
                <MenuItem Header="Українська" 
                          IsChecked="{Binding SelectedSoftwareLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='uk-UA'}"
                          Command="{Binding SoftwareLanguageChangeCommand}" 
                          CommandParameter="uk-UA" />
                <MenuItem Header="Português" 
                          IsChecked="{Binding SelectedSoftwareLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='pt'}"
                          Command="{Binding SoftwareLanguageChangeCommand}" 
                          CommandParameter="pt" />
                <MenuItem Header="Italiano" 
                          IsChecked="{Binding SelectedSoftwareLanguage, Mode=OneWay, Converter={StaticResource LanguageConverter}, ConverterParameter='it-IT'}"
                          Command="{Binding SoftwareLanguageChangeCommand}" 
                          CommandParameter="it-IT" />
            </MenuItem>
            <MenuItem Header="{x:Static resx:LangResx.Snapshot_Folder}" Command="{Binding SetScreenShotDirCommand}"/>
            <MenuItem Header="{x:Static resx:LangResx.Shortcuts}">
                <MenuItem Header="{x:Static resx:LangResx.Backward_Shortcut}" Command="{Binding ShortcutBackwardCommand}"/>
                <MenuItem Header="{x:Static resx:LangResx.Forward_Shortcut}" Command="{Binding ShortcutForwardCommand}"/>
                <MenuItem Header="{x:Static resx:LangResx.Volume_Shortcut}" Command="{Binding ShortcutVolumeCommand}" />
                <MenuItem Header="{x:Static resx:LangResx.Snapshot_Shortcut}" Command="{Binding ShortcutScreenshotCommand}" />
            </MenuItem>
        </MenuItem>

        <!-- 帮助菜单 -->
        <MenuItem Header="{x:Static resx:LangResx.Help}">
            <MenuItem Header="{x:Static resx:LangResx.Feedback}" Command="{Binding FeedbackCommand}">
                <MenuItem.Icon>
                    <TextBlock Text="💬" FontSize="14"/>
                </MenuItem.Icon>
            </MenuItem>
            <MenuItem Header="{x:Static resx:LangResx.Check_for_Updates}" Command="{Binding CheckUpdatesCommand}">
                <MenuItem.Icon>
                    <TextBlock Text="🔄" FontSize="14"/>
                </MenuItem.Icon>
            </MenuItem>
            <Separator/>
            <MenuItem Header="{x:Static resx:LangResx.About}" Command="{Binding AboutCommand}">
                <MenuItem.Icon>
                    <TextBlock Text="ℹ" FontSize="14"/>
                </MenuItem.Icon>
            </MenuItem>
        </MenuItem>
    </Menu>
</UserControl>